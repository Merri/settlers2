<!DOCTYPE html><!--[if IE]><![endif]-->
<html>
	<head>
		<meta charset="UTF-8" />
		<title>The Settlers II.net Map Generator</title>
		<link href="index.css?2014-09-04-2145" rel="stylesheet" type="text/css" />
		<script src="map.js?2014-04-04-2145"></script>
		<script src="generator.js?2014-09-04-2145"></script>
		<script src="http://cdn.jsdelivr.net/filesaver.js/0.2/FileSaver.min.js" type="text/javascript"></script>

	</head>
	<body>
		<h1>The Settlers II.net Map Generator</h1>
		<p>Create random maps for <a href="http://www.gog.com/game/the_settlers_2_gold_edition">The Settlers II</a> and <a href="http://www.rttr.info/"><abbr title="Return to the Roots">RttR</abbr></a>!</p>
		<p>This is an old version! Also check out the <a href="/map-generator/">current version</a>!</p>
		<section class="map-view-container">
			<header>Map View</header>
			<div class="player-positions">
				<canvas id="view" class="settlers2-map" width="256" height="256"></canvas>
				<i class="player-position" id="player0"></i>
				<i class="player-position" id="player1"></i>
				<i class="player-position" id="player2"></i>
				<i class="player-position" id="player3"></i>
				<i class="player-position" id="player4"></i>
				<i class="player-position" id="player5"></i>
				<i class="player-position" id="player6"></i>
				<span title="Return to the Roots only!">
					<i class="player-position player-position-rttr" id="player7"></i>
					<i class="player-position player-position-rttr" id="player8"></i>
					<i class="player-position player-position-rttr" id="player9"></i>
				</span>
			</div><br />
			<label>
				Display as: 
				<select id="viewType">
					<option value="seed">Seed</option>
					<option value="height">Height Map</option>
					<option value="light" selected>Light Map</option>
					<option value="pretty">Pretty</option>
				</select>
			</label>
			<ul>
				<li><strong>Title:</strong> <input id="title" maxlength="19" value="Unknown map" />
				<li><strong>Players:</strong> <span id="player-count">0</span></li>
			</ul>
			<ol>
				<li><button id="new-seed">New Seed</button></li>
				<li><button id="update-height-map">Update Height Map</button></li>
				<li><button id="update-texture">Update Textures</button></li>
				<li><button id="randomize-players">Randomize Players</button></li>
				<li><button id="apply-resources">Apply Resources</button></li>
				<li>
					<small style="width:15em">Compatible with both Settlers II and RttR!</small>
					<button id="save">Download (<small style="font-weight:bold;color:red;">Beta Quality</small>)</button>
				</li>
			</ol>
		</section>
		<div class="tabs">
  
			<div class="tab">
				<input class="tab-radio" type="radio" id="tab-1" name="tab-group-1" checked />
				<label class="tab-label" for="tab-1">1: Seed</label>

				<div class="tab-panel">
					<div class="tab-content">
						<p>A seed will determine the general shape of the land created. Everything else that will be done after seed will be based on what the seed tells. Only a few things will not depend on it (such as random noise or player placement).</p>
						<p>Unlike other map generators the seed in this generator is the size of the map. This gives you a lot of potential for creating a great variety of different kinds of maps with the same tool and same generic rules that are applied based on the seed.</p>
						<ul>
							<li>
								<label>
									Width:
									<select id="width">
										<option value="64">64</option>
										<option value="80">80</option>
										<option value="96">96</option>
										<option value="128">128</option>
										<option value="144">144</option>
										<option value="160">160</option>
										<option value="176">176</option>
										<option value="192">192</option>
										<option value="208">208</option>
										<option value="224">224</option>
										<option value="240">240</option>
										<option value="256" selected>256</option>
										<option value="320">320 (RttR only!)</option>
										<option value="384">384 (RttR only!)</option>
										<option value="448">448 (RttR only!)</option>
										<option value="512">512 (RttR only!)</option>
										<option value="640">640 (RttR only!)</option>
										<option value="768">768 (RttR only!)</option>
										<option value="1024">1024 (You're insane!)</option>
									</select>
								</label>
								<label>
									Height:
									<select id="height">
										<option value="64">64</option>
										<option value="80">80</option>
										<option value="96">96</option>
										<option value="128">128</option>
										<option value="144">144</option>
										<option value="160">160</option>
										<option value="176">176</option>
										<option value="192">192</option>
										<option value="208">208</option>
										<option value="224">224</option>
										<option value="240">240</option>
										<option value="256" selected>256</option>
										<option value="320">320 (RttR only!)</option>
										<option value="384">384 (RttR only!)</option>
										<option value="448">448 (RttR only!)</option>
										<option value="512">512 (RttR only!)</option>
										<option value="640">640 (RttR only!)</option>
										<option value="768">768 (RttR only!)</option>
										<option value="1024">1024 (You really are!)</option>
									</select>
								</label>
							</li>
							<li>
								<label>
									Border Protection:
									<select id="border-protection">
										<option value="3">1/3</option>
										<option value="4">1/4</option>
										<option value="5">1/5</option>
										<option value="6" selected>1/6</option>
										<option value="7">1/7</option>
										<option value="8">1/8</option>
										<option value="9">1/9</option>
										<option value="10">1/10</option>
										<option value="0">Who needs protection?</option>
									</select>
								</label>
								<small>Determines where starting points are randomized at.</small>
							</li>
							<li>
								<label>Starting Points: <input id="startingPoints" type="number" min="1" max="512" value="35" /></label>
								<small>Smaller amount generates less, but bigger land masses. Less points also give less roughness.</small>
							</li>
							<li>
								<label>Minimum landmass ratio%: <input id="massRatio" type="number" min="1" max="99" value="55" /></label>
								<small>Cover atleast this much area.</small>
							</li>
							<li>
								<dl>
									<dt>Fill rates (1 - 999)</dt>
									<dd>
										<label>#1: <input id="likelyhood1" type="number" min="1" max="999" value="1" title="High values easily generate a lot of elevation" /></label>
									</dd>
									<dd>
										<label>#2: <input id="likelyhood2" type="number" min="1" max="999" value="15" title="High values generate rough terrain" /></label>
									</dd>
									<dd>
										<label>#3: <input id="likelyhood3" type="number" min="1" max="999" value="500" title="High values generate flat terrain" /></label>
									</dd>
									<dd>
										<label>#4: <input id="likelyhood4" type="number" min="1" max="999" value="500" title="Give a boost to flat terrain" /></label>
									</dd>
									<dd>
										<label>#5: <input id="likelyhood5" type="number" min="1" max="999" value="500" title="High values here boost effect of #3 and #4" /></label>
									</dd>
									<dd>
										<label>#6: <input id="likelyhood6" type="number" min="1" max="999" value="500" title="Often has the least effect on final result" /></label>
									</dd>
								</dl>
								<small>These control the land expansion when it is randomly expanding. #1 and #2 often control roughness, #3 and #4 can guarantee flat level areas to exist at some parts of the map.</small>
								<p>
									Tips:<br />
									<strong>Super flat</strong>: 1, 1, 999, 999, 999, 999 (1 - 30 starting points)<br />
									<strong>Mars</strong>: 1, 999, 500, 500, 500, 500 (1 - 30 starting points)<br />
								</p>
							</li>
						</ul>

					</div>
				</div>
			</div>

			<div class="tab">
				<input class="tab-radio" type="radio" id="tab-2" name="tab-group-1" />
				<label class="tab-label" for="tab-2">2: Height</label>

				<div class="tab-panel">
					<div class="tab-content">

						<p>Height map determines the flatness or roughness of the map. Water is placed on the Base Level, while mountains are determined with their own logic. In the next step you can choose what will actually represent "water" and what will be "land". Mountains are such a hard requirement in the game that you can't directly replace them with another texture.</p>
						<ul>
							<li>
								<label>
									Base Level:
									<select id="baseLevel">
										<option value="0" selected>0 (generate mountains rather than canyons)</option>
										<option value="30">30 (generate mountains and canyons equally)</option>
										<option value="60">60 (generate canyons rather than mountains)</option>
									</select>
								</label>
							</li>
							<li>
								<label>
									Ground Level:
									<select id="groundLevel">
										<option value="0">No change</option>
										<option value="1">1</option>
										<option value="2">2</option>
										<option value="3">3</option>
										<option value="4">4</option>
										<option value="5" selected>5</option>
									</select>
								</label>
								<small>Extra difference in height to areas dedicated for water, resulting in higher coasts when value is bigger.</small>
							</li>
							<li>
								<label>
									Flatten:
									<select id="flatten">
										<option value="1">No flattening</option>
										<option value="1.25">A bit</option>
										<option value="1.5">Some</option>
										<option value="2">Half the height</option>
										<option value="3">One third of the height</option>
										<option value="4">One fourth of the height</option>
										<option value="5">One fifth of the height</option>
										<option value="10">There will hardly be any height left</option>
										<option value="15">I like my maps flat</option>
										<option value="30">Who needs height differences?</option>
									</select>
								</label>
								<small>Unplayable map due to too big height differences? This post-processing will solve that for you.</small>
							</li>
							<li>
								<label>
									Noise:
									<select id="randomize-height">
										<option value="0">No random noise</option>
										<option value="0.125">Very gentle</option>
										<option value="0.25" selected>Gentle</option>
										<option value="0.75">Weak</option>
										<option value="1">Noticeable</option>
										<option value="1.5">Medium</option>
										<option value="2">Strong</option>
										<option value="3">Powerful</option>
										<option value="4">I dislike flat</option>
										<option value="5">Make it almost unplayable</option>
									</select>
								</label>
								<small>Use this to get rid of uninteresting totally flat terrain.</small>
							</li>
							<li>
								<label>
									<input id="randomize-on-water" type="checkbox" />
									Apply Noise to Water Texture
								</label>
								<small>When applying noise, also use it on texture that is set as the "water" texture?</small>
							</li>
						</ul>

					</div>
				</div>
			</div>

			<div class="tab">
				<input class="tab-radio" type="radio" id="tab-3" name="tab-group-1" />
				<label class="tab-label" for="tab-3">3: Textures</label>

				<div class="tab-panel">
					<div class="tab-content">

						<p>Here you can control the general appearance, feel and playability of the map via textures. You can choose between three different terrains and control representation of general "land" and "water" areas. For instance, you can replace water with lava or prefer savannah over meadows.</p>
						<ul>
							<li>
								<label>
									Terrain:
									<select id="terrain">
										<option value="0" selected>Greenland</option>
										<option value="1">Wasteland</option>
										<option value="2">Winter World</option>
									</select>
								</label>
								<hr />
							</li>
							<li>
								<label>
									Base Texture:
									<select id="base-texture">
										<option value="0">Savannah / Dark Steppe / Taiga</option>
										<option value="8" selected>Meadow #1 / Pasture #1 / Taiga Tundra</option>
										<option value="9">Meadow #2 / Pasture #2 / Tundra #1</option>
										<option value="10">Meadow #3 / Pasture #3 / Tundra #2</option>
										<option value="14">Steppe / Light Steppe / Tundra #3</option>
										<option value="15">Flower Meadow / Flower Pasture / Tundra #4</option>
									</select>
								</label>
								<small>The default habitable and arable texture to use in the ground.</small>
							</li>
							<li>
								<label>
									Water Texture:
									<select id="water-texture">
										<optgroup label="Sane options">
											<option value="5" selected>Water / Moor</option>
											<option value="2">Snow / Lava + few stones / Few ice floes</option>
											<option value="3">Swamp / Lava + many stones / Many ice floes</option>
											<option value="4">Desert #1 / Wasteland #1 / Ice #1</option>
											<option value="16">Lava</option>
										</optgroup>
										<optgroup label="Insane options (RttR incompatible)">
											<option value="7">Desert #2 / Wasteland #2 / Ice #2 (ice has buggy edge)</option>
											<option value="17">Magenta / Dark Red / Black</option>
											<option value="19">Water / Moor (like lava/swamp/snow, no ships)</option>
											<option value="20">Lava #2 (Magenta / Dark Red / Black)</option>
											<option value="21">Lava #3 (Magenta / Dark Red / Black)</option>
											<option value="22">Lava #4 (Magenta / Dark Red / Black)</option>
										</optgroup>
										<optgroup label="Habitable (buildable)">
											<option value="18">Mountain Meadow</option>
											<option value="6">Water (habitable), no RttR support</option>
											<option value="34">Mountain (habitable), no RttR support</option>
										</optgroup>
									</select>
								</label>
								<small>Texture that works as flat surface. Some of these textures become more interesting in The Settlers II when using <a href="http://settlers2.net/the-settlers-2/texture-set-new-greenland/">Merri's New Greenland</a>.</small>
							</li>
							<li>
								<label>
									Mountain Generation:
									<select id="mountain-generate">
										<option value="7">Any node surrounded by 6 flag poles</option>
										<option value="6" selected>Any node with flag pole, surrounded by 6 flag poles</option>
										<option value="5">Any node with flag pole, surrounded by 5 flag poles or more</option>
										<option value="4">Any node with flag pole, surrounded by 4 flag poles or more</option>
										<option value="3">Any node with flag pole, surrounded by 3 flag poles or more</option>
									</select>
								</label>
								<small>This is a simple rule for generating mountains. Desert tiles are preserved.</small>
							</li>
							<li>
								<label>
									Seamless Mode:
									<select id="seamless">
										<option value="0" selected>Off - Support The Settlers II</option>
										<option value="1">On - Not supported by The Settlers II (crashes game)</option>
									</select>
								</label>
								<small>If not enabled textures are painted around map edges so that making roads around the edges is not possible.</small>
							</li>
						</ul>

					</div>
				</div>
			</div>

			<div class="tab">
				<input class="tab-radio" type="radio" id="tab-4" name="tab-group-1" />
				<label class="tab-label" for="tab-4">4: Players</label>

				<div class="tab-panel">
					<div class="tab-content">

						<p>Nothing special here: just set the number of players and the engine attempts to generate as many players as you want.</p>
						<ul>
							<li>
								<label>
									Max number of players:
									<select id="maximum-players">
										<option value="0">No players</option>
										<option value="1">1 player</option>
										<option value="2">2 players</option>
										<option value="3">3 players</option>
										<option value="4">4 players</option>
										<option value="5">5 players</option>
										<option value="6">6 players</option>
										<option value="7" selected>7 players</option>
										<option value="8">8 players (RttR only!)</option>
										<option value="9">9 players (RttR only!)</option>
										<option value="10">10 players (RttR only!)</option>
									</select>
								</label>
							</li>
							<li>
								<label>
									Player safe zone:
									<select id="player-safe-zone">
										<option value="15">Non-existant (15 nodes)</option>
										<option value="25">Weak (25 nodes)</option>
										<option value="35">Moderate (35 nodes)</option>
										<option value="50" selected>Good (50 nodes)</option>
										<option value="75">Strong (75 nodes)</option>
										<option value="100">Peaceful (100 nodes)</option>
										<option value="150">Have you seen the Enemy? (150 nodes)</option>
										<option value="200">Meeting anyone will take a while&hellip; (200 nodes)</option>
									</select>
								</label>
								<small>How close should it be possible for another player to be randomized?</small>
							</li>
						</ul>

					</div>
				</div>
			</div>

			<div class="tab">
				<input class="tab-radio" type="radio" id="tab-5" name="tab-group-1" />
				<label class="tab-label" for="tab-5">5: Resources</label>

				<div class="tab-panel">
					<div class="tab-content">

						<p>Sorry, no customization options available at this time.</p>

					</div>
				</div>
			</div>

			<div class="tab">
				<input class="tab-radio" type="radio" id="tab-6" name="tab-group-1" />
				<label class="tab-label" for="tab-6">TODO</label>

				<div class="tab-panel">
					<div class="tab-content">

						<del><strong>TODO: shortest route to happy jh</strong>
						<ol>
							<li>Generate WLD/SWD file</li>
							<li>Add support for downloading the file</li>
						</ol></del>
						<hr />
						<header><del>TODO: shortest route to playable maps</del></header>
						<ol>
							<li><del>Ability to set textures</del></li>
							<li><del>Set initial base textures (water and mixed meadow)</del></li>
							<li><del>Calculate building sites</del></li>
							<li><del>Determine mountain areas and set mountain textures</del></li>
							<li><del>Add players to random positions</del></li>
							<li><del>Add random forests and granite</del></li>
							<li><del>Add mountain resources and water and fish</del></li>
							<li><del>Calculate other information required by The Settlers II</del></li>
						</ol>
						<hr />
						<header>TODO: Go open source: GitHub!</header>
						<p>Once the TODO list above is complete... we are out of alpha and then good enough for GitHub.</p>
						<hr />
						<strong>TODO: Other features</strong>
						<ul>
							<li>Add animals</li>
							<li>Add decorative objects</li>
							<li>Support for Wasteland and Winter World textures</li>
							<li>Adjustable texture selection and rules for texture usage</li>
							<li>Harbors</li>
							<li>Know if every player can encounter every other player</li>
							<li>Further texture support: deserts, snow, swamps...</li>
							<li>Intelligent texture, tree and granite placement</li>
							<li>Intelligent resource placement</li>
							<li>Virtual playing: see how easily a player can expand and how easily will get in touch with other players</li>
							<li>Challenge indicator for a player</li>
							<li>Adjustable challenge per player</li>
						</ul>
						<hr />
						<strong>The Settlers II and Return to the Roots</strong>
						<p>Read more about the games at <a href="http://settlers2.net/">settlers2.net</a></p>

					</div>
				</div>
			</div>
		</div>
		<script>
(function(global) {
	var tooManyTries = 0,
		// buttons
		newSeedButton = document.getElementById('new-seed'),
		updateHeightMapButton = document.getElementById('update-height-map'),
		updateTextureButton = document.getElementById('update-texture'),
		randomizePlayersButton = document.getElementById('randomize-players'),
		applyResourcesButton = document.getElementById('apply-resources'),

		viewElement = document.getElementById('view'),

		viewTypeElement = document.getElementById('viewType'),
		terrainElement = document.getElementById('terrain'),
		maximumPlayers = document.getElementById('maximum-players'),
		playerSafeZone = document.getElementById('player-safe-zone');

	// best view controller ever
	newSeedButton.onclick = function() {
		Generator.seed({
			width: document.getElementById('width').value,
			height: document.getElementById('height').value,
			borderProtection: document.getElementById('border-protection').value,
			likelyhood: [
				0,
				~~document.getElementById('likelyhood1').value / 1000,
				~~document.getElementById('likelyhood2').value / 1000,
				~~document.getElementById('likelyhood3').value / 1000,
				~~document.getElementById('likelyhood4').value / 1000,
				~~document.getElementById('likelyhood5').value / 1000,
				~~document.getElementById('likelyhood6').value / 1000
			],
			massRatio: document.getElementById('massRatio').value,
			startingPoints: document.getElementById('startingPoints').value
		});
		updateHeightMapButton.click();
	};

	updateHeightMapButton.onclick = function() {
		Generator.createHeight({
			baseLevel: document.getElementById('baseLevel').value,
			flatten: document.getElementById('flatten').value,
			groundLevel: document.getElementById('groundLevel').value,
			randomize: document.getElementById('randomize-height').value,
			noiseOnWater: document.getElementById('randomize-on-water').checked
		});
		updateTextureButton.click();
	};

	updateTextureButton.onclick = function() {
		Generator.createBaseTextures({
			mountainGenerate: document.getElementById('mountain-generate').value,
			seamless: document.getElementById('seamless').value,
			terrain: terrainElement.value,
			texture: document.getElementById('base-texture').value,
			waterTexture: document.getElementById('water-texture').value
		});
		randomizePlayersButton.click();
	};

	randomizePlayersButton.onclick = function() {
		var positions = Generator.getRandomPlayerPositions(maximumPlayers.value, playerSafeZone.value),
			element;

		// move the player location indicators
		for(i = 0; i < positions.length; i++) {
			element = document.getElementById('player' + i);
			element.style.left = positions[i].x + 'px';
			element.style.top = positions[i].y + 'px';
		}

		// if no room for more players then we just remove the rest
		for(; i < 10; i++) {
			element = document.getElementById('player' + i);
			element.style.left = '';
			element.style.top = '';
		}

		document.getElementById('player-count').innerHTML = positions.length;

		applyResourcesButton.click();
	};

	applyResourcesButton.onclick = function() {
		console.log(Generator.applyResources({}));
		viewTypeElement.click();
	}

	viewTypeElement.onclick = viewTypeElement.onchange = function() {
		Generator.draw({
			canvas: viewElement,
			terrain: terrainElement.value,
			viewType: viewTypeElement.value
		});
		switch(~~terrainElement.value) {
		case 1:
			viewElement.className = 'settlers2-map settlers2-map--wasteland';
			break;
		case 2:
			viewElement.className = 'settlers2-map settlers2-map--winter-world';
			break;
		default:
			viewElement.className = 'settlers2-map settlers2-map--greenland';
		}
	};

	document.getElementById('save').onclick = function() {
		saveAs(Generator.getFileBlob({
			terrain: terrainElement.value,
			title: document.getElementById('title').value
		}), 'New Map.swd');
	};

	function waitingToClick() {
		if(Generator.isPrettyReady() === true) {
			viewTypeElement.value = 'pretty';
			newSeedButton.click();
		} else if(Generator.isPrettyReady() === false) {
			viewTypeElement.value = 'light';
			newSeedButton.click();
		} else {
			tooManyTries++;
			console.log('Not ready to paint...');
			if(tooManyTries < 10) {
				setTimeout(waitingToClick, 100);
			} else {
				viewTypeElement.value = 'light';
				newSeedButton.click();
			}
		}
	};

	if(window.location.hostname === 'settlers2.net') {
		window.onload = waitingToClick;
	} else {
		setTimeout(waitingToClick, 0);
	}
})(this);
		</script>
		<script>
if(window.location.hostname === 'settlers2.net') {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-24741042-1', 'auto');
	ga('send', 'pageview');
}
		</script>
	</body>
</html>